<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="åŸºæº–ç‚¹ã®è©³ç´°æƒ…å ±">
  <meta name="theme-color" content="#2196F3">
  <title>åŸºæº–ç‚¹è©³ç´°</title>
  
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    #map {
      width: 100%;
      height: 300px;
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .detail-header {
      background: white;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .point-name {
      font-size: 24px;
      font-weight: 700;
      color: #2196F3;
      margin-bottom: 8px;
    }

    .point-info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .info-item {
      padding: 12px;
      background: #f5f5f5;
      border-radius: 4px;
    }

    .info-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
    }

    .info-value {
      font-size: 16px;
      font-weight: 600;
      color: #333;
    }

    .photo-upload-section {
      background: white;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .photo-upload-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .photo-upload-item {
      text-align: center;
    }

    .photo-upload-item label {
      display: block;
      width: 100%;
      aspect-ratio: 3 / 4;
      border: 2px dashed #2196F3;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: #f0f7ff;
      transition: all 0.3s ease;
    }

    .photo-upload-item label:hover {
      background: #e3f2fd;
      border-color: #1976D2;
    }

    .photo-upload-item input[type="file"] {
      display: none;
    }

    .photo-preview {
      width: 100%;
      aspect-ratio: 3 / 4;
      object-fit: cover;
      border-radius: 8px;
    }

    .history-input-section {
      background: white;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .mode-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .gps-info {
      background: #f5f5f5;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      display: none;
    }

    .gps-info.active {
      display: block;
    }

    .direction-display {
      font-size: 36px;
      text-align: center;
      margin-bottom: 12px;
      font-weight: 700;
    }

    .distance-display {
      font-size: 48px;
      text-align: center;
      color: #2196F3;
      margin-bottom: 12px;
      font-weight: 700;
    }

    .gps-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .gps-detail-item {
      background: white;
      padding: 12px;
      border-radius: 4px;
      text-align: center;
    }

    .gps-detail-value {
      font-size: 18px;
      font-weight: 600;
      color: #2196F3;
    }

    .gps-detail-label {
      font-size: 12px;
      color: #666;
    }

    .back-button {
      display: inline-block;
      margin-bottom: 16px;
      padding: 8px 16px;
      background: #f5f5f5;
      color: #333;
      text-decoration: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }

    .back-button:hover {
      background: #e0e0e0;
    }
  </style>
</head>
<body>
  <header>
    <h1>åŸºæº–ç‚¹è©³ç´°</h1>
    <p class="subtitle">è©³ç´°æƒ…å ±ã¨æ¢ç´¢è¨˜éŒ²</p>
  </header>

  <main>
    <div class="container">
      <a href="javascript:history.back()" class="back-button">â† æˆ»ã‚‹</a>

      <!-- åŸºæœ¬æƒ…å ± -->
      <div class="detail-header">
        <div class="point-name" id="point-name">ç‚¹å</div>
        
        <div class="point-info-grid">
          <div class="info-item">
            <div class="info-label">åŸºæº–ç‚¹ç¨®åˆ¥</div>
            <div class="info-value" id="point-type">ä¸‰è§’ç‚¹</div>
          </div>
          <div class="info-item">
            <div class="info-label">éƒ½é“åºœçœŒ</div>
            <div class="info-value" id="point-prefecture">æ±äº¬éƒ½</div>
          </div>
          <div class="info-item">
            <div class="info-label">å¸‚åŒºç”ºæ‘</div>
            <div class="info-value" id="point-city">åƒä»£ç”°åŒº</div>
          </div>
          <div class="info-item">
            <div class="info-label">æ¨™é«˜</div>
            <div class="info-value" id="point-elevation">6.2m</div>
          </div>
        </div>

        <div class="info-item">
          <div class="info-label">èª¬æ˜</div>
          <div class="info-value" id="point-description" style="font-size: 14px; font-weight: 400;">
            èª¬æ˜æ–‡ãŒå…¥ã‚Šã¾ã™
          </div>
        </div>
      </div>

      <!-- åœ°å›³è¡¨ç¤º -->
      <div id="map"></div>

      <!-- æ¸¬è¨­ãƒ¢ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ -->
      <div class="mode-buttons">
        <button class="btn" id="surveying-mode-btn">ğŸ§­ æ¸¬è¨­ãƒ¢ãƒ¼ãƒ‰</button>
        <button class="btn btn-secondary" id="close-surveying-btn" style="display: none;">âœ• çµ‚äº†</button>
      </div>

      <!-- GPSæƒ…å ±è¡¨ç¤ºï¼ˆæ¸¬è¨­ãƒ¢ãƒ¼ãƒ‰ï¼‰ -->
      <div class="gps-info" id="gps-info">
        <div class="direction-display" id="direction-display">N</div>
        <div class="distance-display" id="distance-display">---m</div>
        
        <div class="gps-details">
          <div class="gps-detail-item">
            <div class="gps-detail-value" id="accuracy-display">--</div>
            <div class="gps-detail-label">ç²¾åº¦(m)</div>
          </div>
          <div class="gps-detail-item">
            <div class="gps-detail-value" id="bearing-display">--</div>
            <div class="gps-detail-label">æ–¹ä½è§’(Â°)</div>
          </div>
          <div class="gps-detail-item">
            <div class="gps-detail-value" id="altitude-display">--</div>
            <div class="gps-detail-label">é«˜åº¦(m)</div>
          </div>
          <div class="gps-detail-item">
            <div class="gps-detail-value" id="speed-display">--</div>
            <div class="gps-detail-label">é€Ÿåº¦(km/h)</div>
          </div>
        </div>

        <p class="text-muted text-center mt-16" id="proximity-message"></p>
      </div>

      <!-- å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
      <div class="photo-upload-section">
        <h3 style="margin-bottom: 16px;">å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h3>
        
        <div class="photo-upload-grid">
          <div class="photo-upload-item">
            <label for="nearby-photo">
              <div>
                <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“¸</div>
                <div>è¿‘æ™¯</div>
                <div style="font-size: 12px; color: #666; margin-top: 4px;">(3:4)</div>
              </div>
              <input type="file" id="nearby-photo" accept="image/*" capture="environment">
            </label>
            <img id="nearby-preview" class="photo-preview hidden" alt="è¿‘æ™¯">
          </div>

          <div class="photo-upload-item">
            <label for="distant-photo">
              <div>
                <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“·</div>
                <div>é æ™¯</div>
                <div style="font-size: 12px; color: #666; margin-top: 4px;">(3:4)</div>
              </div>
              <input type="file" id="distant-photo" accept="image/*" capture="environment">
            </label>
            <img id="distant-preview" class="photo-preview hidden" alt="é æ™¯">
          </div>
        </div>
      </div>

      <!-- æ¢ç´¢å±¥æ­´å…¥åŠ› -->
      <div class="history-input-section">
        <h3 style="margin-bottom: 16px;">æ¢ç´¢å±¥æ­´</h3>
        
        <div class="form-group">
          <label for="visit-date">æ¢ç´¢æ—¥</label>
          <input type="date" id="visit-date">
        </div>

        <div class="form-group">
          <label for="visit-notes">ãƒ¡ãƒ¢</label>
          <textarea id="visit-notes" placeholder="æ¢ç´¢æ™‚ã®çŠ¶æ³ã‚„æ°—ã¥ã„ãŸã“ã¨ãªã©ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„"></textarea>
        </div>

        <div class="form-group">
          <label for="visit-weather">å¤©æ°—</label>
          <select id="visit-weather">
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="æ™´ã‚Œ">æ™´ã‚Œ</option>
            <option value="æ›‡ã‚Š">æ›‡ã‚Š</option>
            <option value="é›¨">é›¨</option>
            <option value="é›ª">é›ª</option>
            <option value="ãã®ä»–">ãã®ä»–</option>
          </select>
        </div>

        <button class="btn btn-success btn-block" id="save-visit-btn">
          âœ“ æ¢ç´¢ã‚’è¨˜éŒ²
        </button>
      </div>

      <!-- è©³ç´°æƒ…å ± -->
      <div class="card">
        <div class="card-header">
          <h3>è©³ç´°æƒ…å ±</h3>
        </div>
        <div class="card-body">
          <div class="point-info-grid">
            <div class="info-item">
              <div class="info-label">ç²¾åº¦</div>
              <div class="info-value" id="detail-accuracy">ä¸€ç­‰ä¸‰è§’ç‚¹</div>
            </div>
            <div class="info-item">
              <div class="info-label">æ¨™è­˜ç¨®åˆ¥</div>
              <div class="info-value" id="detail-mark-type">é‡‘å±æ¨™</div>
            </div>
            <div class="info-item">
              <div class="info-label">è¨­ç½®æ—¥</div>
              <div class="info-value" id="detail-install-date">1889</div>
            </div>
            <div class="info-item">
              <div class="info-label">è¿‘éš£ãƒ©ãƒ³ãƒ‰ãƒãƒ¼ã‚¯</div>
              <div class="info-value" id="detail-landmark">çš‡å±…</div>
            </div>
          </div>

          <div class="info-item mt-16">
            <div class="info-label">å‚™è€ƒ</div>
            <div class="info-value" id="detail-remarks" style="font-size: 14px; font-weight: 400;">
              å‚™è€ƒæƒ…å ±
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="/js/db.js"></script>
  <script src="/js/detail.js"></script>
</body>
</html>
